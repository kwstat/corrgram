<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples for the corrgram package • corrgram</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples for the corrgram package">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">corrgram</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/corrgram_cov2cor.html">Finding the nearest proper correlation matrix</a>
    </li>
    <li>
      <a href="../articles/corrgram_examples.html">Examples for the corrgram package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Examples for the corrgram package</h1>
                        <h4 class="author">Kevin Wright</h4>
            
            <h4 class="date">2019-09-13</h4>
      
      
      <div class="hidden name"><code>corrgram_examples.Rmd</code></div>

    </div>

    
    
<div id="abstract" class="section level2">
<h2 class="hasAnchor">
<a href="#abstract" class="anchor"></a>Abstract</h2>
<p>The <code>corrgram</code> package is an implementation of correlograms. This vignette reproduces most of the figures in <span class="citation">Friendly (2002)</span>.</p>
</div>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"knitr"</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.align=</span><span class="st">"center"</span>, <span class="dt">fig.width=</span><span class="dv">6</span>, <span class="dt">fig.height=</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">width=</span><span class="dv">90</span>)</a></code></pre></div>
<p>The data are 11 measures of performance and salary for 263 baseball players in the 1986 baseball season in the United States. The data were used in 1988 Data Expo at the Joint Statistical Meetings.</p>
<p>The first 6 rows of the data and the upper-left corner of the correlation matrix are given below.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"corrgram"</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(baseball)</a></code></pre></div>
<pre><code>##             Name League Team Position Atbat Hits Homer Runs RBI Walks Years Atbatc Hitsc
## 1 Andy Allanson       A  CLE       C    293   66     1   30  29    14     1    293    66
## 2 Alan Ashby          N  HOU       C    315   81     7   24  38    39    14   3449   835
## 3 Alvin Davis         A  SEA       1B   479  130    18   66  72    76     3   1624   457
## 4 Andre Dawson        N  MON       OF   496  141    20   65  78    37    11   5628  1575
## 5 A Galarraga         N  MON       1B   321   87    10   39  42    30     2    396   101
## 6 A Griffin           A  OAK       SS   594  169     4   74  51    35    11   4408  1133
##   Homerc Runsc RBIc Walksc Putouts Assists Errors Salary   logSal
## 1      1    30   29     14     446      33     20     NA       NA
## 2     69   321  414    375     632      43     10    475 2.676694
## 3     63   224  266    263     880      82     14    480 2.681241
## 4    225   828  838    354     200      11      3    500 2.698970
## 5     12    48   46     33     805      40      4     92 1.963788
## 6     19   501  336    194     282     421     25    750 2.875061</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(baseball[, <span class="dv">5</span><span class="op">:</span><span class="dv">14</span>], <span class="dt">use=</span><span class="st">"pair"</span>),<span class="dv">2</span>)</a></code></pre></div>
<pre><code>##        Atbat Hits Homer Runs  RBI Walks Years Atbatc Hitsc Homerc
## Atbat   1.00 0.97  0.59 0.91 0.82  0.67  0.05   0.24  0.25   0.24
## Hits    0.97 1.00  0.56 0.92 0.81  0.64  0.04   0.23  0.26   0.20
## Homer   0.59 0.56  1.00 0.65 0.86  0.48  0.12   0.22  0.22   0.49
## Runs    0.91 0.92  0.65 1.00 0.80  0.73  0.00   0.19  0.20   0.23
## RBI     0.82 0.81  0.86 0.80 1.00  0.62  0.15   0.29  0.31   0.44
## Walks   0.67 0.64  0.48 0.73 0.62  1.00  0.14   0.28  0.28   0.33
## Years   0.05 0.04  0.12 0.00 0.15  0.14  1.00   0.92  0.90   0.73
## Atbatc  0.24 0.23  0.22 0.19 0.29  0.28  0.92   1.00  1.00   0.80
## Hitsc   0.25 0.26  0.22 0.20 0.31  0.28  0.90   1.00  1.00   0.78
## Homerc  0.24 0.20  0.49 0.23 0.44  0.33  0.73   0.80  0.78   1.00</code></pre>
</div>
<div id="figure-2" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-2" class="anchor"></a>Figure 2</h2>
<p>Figure 2 shows two ways to graphically display the correlation matrix using the <code><a href="../reference/corrgram.html">panel.shade()</a></code> and <code><a href="../reference/corrgram.html">panel.pie()</a></code> functions.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">vars2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Assists"</span>,<span class="st">"Atbat"</span>,<span class="st">"Errors"</span>,<span class="st">"Hits"</span>,<span class="st">"Homer"</span>,<span class="st">"logSal"</span>,</a>
<a class="sourceLine" id="cb6-2" title="2">           <span class="st">"Putouts"</span>,<span class="st">"RBI"</span>,<span class="st">"Runs"</span>,<span class="st">"Walks"</span>,<span class="st">"Years"</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(baseball[,vars2], <span class="dt">order=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-4" title="4">         <span class="dt">main=</span><span class="st">"Baseball data PC2/PC1 order"</span>,</a>
<a class="sourceLine" id="cb6-5" title="5">         <span class="dt">lower.panel=</span>panel.shade, <span class="dt">upper.panel=</span>panel.pie,</a>
<a class="sourceLine" id="cb6-6" title="6">         <span class="dt">diag.panel=</span>panel.minmax, <span class="dt">text.panel=</span>panel.txt)</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/fig2-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="figure-3" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-3" class="anchor"></a>Figure 3</h2>
<p>Figure 3 shows an eigenvector plot of the correlation matrix. This forms the basis of the orderings of the variables in the corrgram in Figure 4b in the next section, beginning with “AtBat” and then moving counter-clockwise up to “Years”. Note: Eigenvectors are unique only up to a change of sign.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">baseball.cor &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(baseball[,vars2], <span class="dt">use=</span><span class="st">'pair'</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">baseball.eig &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span>(baseball.cor)<span class="op">$</span>vectors[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb7-3" title="3">e1 &lt;-<span class="st"> </span>baseball.eig[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb7-4" title="4">e2 &lt;-<span class="st"> </span>baseball.eig[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb7-5" title="5"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(e1,e2,<span class="dt">col=</span><span class="st">'white'</span>, <span class="dt">xlim=</span><span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(e1,e2), <span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(e1,e2))</a>
<a class="sourceLine" id="cb7-6" title="6"><span class="kw"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(e1,e2, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(baseball.cor), <span class="dt">cex=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-7" title="7"><span class="kw"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="st">"Eigenvector plot of baseball data"</span>)</a>
<a class="sourceLine" id="cb7-8" title="8"><span class="kw"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span>(<span class="dv">0</span>, <span class="dv">0</span>, e1, e2, <span class="dt">cex=</span><span class="fl">0.5</span>, <span class="dt">col=</span><span class="st">"red"</span>, <span class="dt">length=</span><span class="fl">0.1</span>)</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/fig3-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="figure-4a-4b" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-4a-4b" class="anchor"></a>Figure 4a, 4b</h2>
<p>In figure 4a the variables are sorted in the alphabetical order as given in the data.</p>
<p>In figure 4b, the variables are sorted according to the principal component ordering in Figure 3 to look for possible clustering of the variables. It is not surprising to see that more times at bat is strongly correlated with a higher number of hits and a higher number of runs.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(baseball[,vars2], <span class="dt">main=</span><span class="st">"Baseball data (alphabetic order)"</span>)</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/fig4-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(baseball[,vars2], <span class="dt">order=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb9-2" title="2">         <span class="dt">main=</span><span class="st">"Baseball data (PC order)"</span>,</a>
<a class="sourceLine" id="cb9-3" title="3">         <span class="dt">panel=</span>panel.shade, <span class="dt">text.panel=</span>panel.txt)</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/fig4-2.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="figure-5" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-5" class="anchor"></a>Figure 5</h2>
<p>Figure 5 shows a corrgram for all numeric variables in the dataframe. Non-numeric columns in the data are ignored.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(baseball, <span class="dt">order=</span><span class="ot">TRUE</span>, <span class="dt">main=</span><span class="st">"Baseball data (PC order)"</span>)</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/fig5-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="figure-6-" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-6-" class="anchor"></a>Figure 6.</h2>
<p>Figure 6 shows a corrgram of automotive data on 74 different models of cars from 1979. There are two obvious groups of variables</p>
<p>Note, the arrangement is slightly different from Friendly.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(auto, <span class="dt">order=</span><span class="ot">TRUE</span>, <span class="dt">main=</span><span class="st">"Auto data (PC order)"</span>)</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/fig6-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="figure-7-" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-7-" class="anchor"></a>Figure 7.</h2>
<p>The inverse of the correlation matrix expresses conditional dependence and independence of the variables.</p>
<p>The variables are sorted in the same order as in figure 4. One example interpretation is: controlling for all other variables, there is still a large correlation between Years and log Salary.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">rinv &lt;-<span class="st"> </span><span class="cf">function</span>(r){</a>
<a class="sourceLine" id="cb12-2" title="2">  <span class="co"># r is a correlation matrix</span></a>
<a class="sourceLine" id="cb12-3" title="3">  <span class="co"># calculate r inverse and scale to correlation matrix</span></a>
<a class="sourceLine" id="cb12-4" title="4">  <span class="co"># Derived from Michael Friendly's SAS code</span></a>
<a class="sourceLine" id="cb12-5" title="5"></a>
<a class="sourceLine" id="cb12-6" title="6">  ri &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/solve.html">solve</a></span>(r)</a>
<a class="sourceLine" id="cb12-7" title="7">  s &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(ri)</a>
<a class="sourceLine" id="cb12-8" title="8">  s &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="dv">1</span><span class="op">/</span>s))</a>
<a class="sourceLine" id="cb12-9" title="9">  ri &lt;-<span class="st"> </span>s <span class="op">%*%</span><span class="st"> </span>ri <span class="op">%*%</span><span class="st"> </span>s</a>
<a class="sourceLine" id="cb12-10" title="10">  n &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(ri)</a>
<a class="sourceLine" id="cb12-11" title="11">  ri &lt;-<span class="st"> </span>ri <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span>,n) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">1</span>, n, n))</a>
<a class="sourceLine" id="cb12-12" title="12">  <span class="kw"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(ri) &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># Should already be 1, but could be 1 + epsilon</span></a>
<a class="sourceLine" id="cb12-13" title="13">  <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(ri) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(ri) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(r)</a>
<a class="sourceLine" id="cb12-14" title="14">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(ri)</a>
<a class="sourceLine" id="cb12-15" title="15">}</a>
<a class="sourceLine" id="cb12-16" title="16"></a>
<a class="sourceLine" id="cb12-17" title="17">vars7 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Years"</span>, <span class="st">"logSal"</span>, <span class="st">"Homer"</span>, <span class="st">"Putouts"</span>, <span class="st">"RBI"</span>, <span class="st">"Walks"</span>,</a>
<a class="sourceLine" id="cb12-18" title="18">           <span class="st">"Runs"</span>, <span class="st">"Hits"</span>, <span class="st">"Atbat"</span>, <span class="st">"Errors"</span>, <span class="st">"Assists"</span>)</a>
<a class="sourceLine" id="cb12-19" title="19">cb &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(baseball[,vars7], <span class="dt">use=</span><span class="st">"pair"</span>)</a>
<a class="sourceLine" id="cb12-20" title="20"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(<span class="op">-</span><span class="kw">rinv</span>(cb), <span class="dt">main=</span><span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Baseball data "</span>, R<span class="op">^-</span><span class="dv">1</span>)))</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/fig7-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="figure-8" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-8" class="anchor"></a>Figure 8</h2>
<p>Figure 8 shows a partial independence corrgram for the automotive data, when Price and MPG are partialed out.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(Matrix) <span class="co"># For block diagonal function</span></a></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">partial &lt;-<span class="st"> </span><span class="cf">function</span>(r, xvar){</a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="co"># r is a correlation matrix</span></a>
<a class="sourceLine" id="cb15-3" title="3">  <span class="co"># Calculate partial correlation of y|x</span></a>
<a class="sourceLine" id="cb15-4" title="4">  yvar &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(r), xvar)</a>
<a class="sourceLine" id="cb15-5" title="5">  ri &lt;-<span class="st"> </span>r[yvar,yvar] <span class="op">-</span><span class="st"> </span>r[yvar,xvar] <span class="op">%*%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html">solve</a></span>(r[xvar,xvar]) <span class="op">%*%</span><span class="st"> </span>r[xvar,yvar]</a>
<a class="sourceLine" id="cb15-6" title="6">  s &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(ri)</a>
<a class="sourceLine" id="cb15-7" title="7">  s &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="dv">1</span><span class="op">/</span>s))</a>
<a class="sourceLine" id="cb15-8" title="8">  ri &lt;-<span class="st"> </span>s <span class="op">%*%</span><span class="st"> </span>ri <span class="op">%*%</span><span class="st"> </span>s</a>
<a class="sourceLine" id="cb15-9" title="9">  ri &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(Matrix<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Matrix/man/bdiag.html">bdiag</a></span>(ri, r[xvar, xvar]))</a>
<a class="sourceLine" id="cb15-10" title="10">  <span class="kw"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(ri) &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># Should already be 1, but could be 1 + epsilon</span></a>
<a class="sourceLine" id="cb15-11" title="11">  <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(ri) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(ri) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(yvar, xvar)</a>
<a class="sourceLine" id="cb15-12" title="12">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(ri)</a>
<a class="sourceLine" id="cb15-13" title="13">}</a>
<a class="sourceLine" id="cb15-14" title="14"></a>
<a class="sourceLine" id="cb15-15" title="15">vars8a &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Gratio"</span>, <span class="st">"Rep78"</span>, <span class="st">"Rep77"</span>, <span class="st">"Hroom"</span>, <span class="st">"Trunk"</span>, <span class="st">"Rseat"</span>,</a>
<a class="sourceLine" id="cb15-16" title="16">            <span class="st">"Length"</span>, <span class="st">"Weight"</span>, <span class="st">"Displa"</span>, <span class="st">"Turn"</span>)</a>
<a class="sourceLine" id="cb15-17" title="17">vars8b &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MPG"</span>, <span class="st">"Price"</span>)</a>
<a class="sourceLine" id="cb15-18" title="18">vars8 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(vars8a, vars8b)</a>
<a class="sourceLine" id="cb15-19" title="19">auto.cor &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(auto[, vars8], <span class="dt">use=</span><span class="st">"pair"</span>)</a>
<a class="sourceLine" id="cb15-20" title="20">auto.par &lt;-<span class="st"> </span><span class="kw">partial</span>(auto.cor, vars8b)</a>
<a class="sourceLine" id="cb15-21" title="21"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(auto.par,</a>
<a class="sourceLine" id="cb15-22" title="22">         <span class="dt">lower.panel=</span>panel.pie, <span class="dt">upper.panel=</span>panel.pie,</a>
<a class="sourceLine" id="cb15-23" title="23">         <span class="dt">main=</span><span class="st">"Auto data, partialing out Price,MPG"</span>)</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/fig8-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="figure-11" class="section level2">
<h2 class="hasAnchor">
<a href="#figure-11" class="anchor"></a>Figure 11</h2>
<p>Figure 11 provides another way to display the data, using both ellipses and loess lines. Long, narrow ellipses represent high correlations while circular ellipses represent low correlations.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(baseball[,vars2], <span class="dt">order=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb16-2" title="2">         <span class="dt">main=</span><span class="st">"Baseball correlation ellipses"</span>,</a>
<a class="sourceLine" id="cb16-3" title="3">         <span class="dt">panel=</span>panel.ellipse,</a>
<a class="sourceLine" id="cb16-4" title="4">         <span class="dt">text.panel=</span>panel.txt, <span class="dt">diag.panel=</span>panel.minmax)</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/ellipse-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="further-examples" class="section level1">
<h1 class="hasAnchor">
<a href="#further-examples" class="anchor"></a>Further examples</h1>
<p>Demonstrate density panel, correlation confidence panel</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(iris,</a>
<a class="sourceLine" id="cb17-2" title="2">         <span class="dt">main=</span><span class="st">"Iris data with example panel functions"</span>,</a>
<a class="sourceLine" id="cb17-3" title="3">         <span class="dt">lower.panel=</span>panel.pts, <span class="dt">upper.panel=</span>panel.conf,</a>
<a class="sourceLine" id="cb17-4" title="4">         <span class="dt">diag.panel=</span>panel.density)</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/scatter-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Demonstrate panel.bar, panel.ellipse, panel.minmax, col.regions</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(auto, <span class="dt">order=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb18-2" title="2">         <span class="dt">main=</span><span class="st">"Auto data (PC order)"</span>,</a>
<a class="sourceLine" id="cb18-3" title="3">         <span class="dt">lower.panel=</span>corrgram<span class="op">::</span>panel.ellipse,</a>
<a class="sourceLine" id="cb18-4" title="4">         <span class="dt">upper.panel=</span>panel.bar, <span class="dt">diag.panel=</span>panel.minmax,</a>
<a class="sourceLine" id="cb18-5" title="5">         <span class="dt">col.regions=</span><span class="kw"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"darkgoldenrod4"</span>, <span class="st">"burlywood1"</span>,</a>
<a class="sourceLine" id="cb18-6" title="6">                                        <span class="st">"darkkhaki"</span>, <span class="st">"darkgreen"</span>)))</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/panelbar-1.png" width="576" style="display: block; margin: auto;"></p>
<div id="correlation-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-matrix" class="anchor"></a>Correlation matrix</h2>
<p>The <code>vote</code> data is a matrix.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># 'vote' is a correlation matrix, not a data frame</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(vote, <span class="dt">order=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb19-3" title="3">         <span class="dt">upper.panel=</span>panel.cor, <span class="dt">main=</span><span class="st">"vote"</span>)</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/vote-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="ratings-data" class="section level2">
<h2 class="hasAnchor">
<a href="#ratings-data" class="anchor"></a>Ratings data</h2>
<p>An example showing one way to plot ratings data.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/connections.html">url</a></span>(<span class="st">"https://github.com/alexanderrobitzsch/sirt/blob/master/data/data.ratings3.rda?raw=true"</span>))</a>
<a class="sourceLine" id="cb20-2" title="2"></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co"># jitter first, so the upper/lower panels are symmetric</span></a>
<a class="sourceLine" id="cb20-4" title="4">data.ratings3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/transform.html">transform</a></span>(data.ratings3,</a>
<a class="sourceLine" id="cb20-5" title="5">                           <span class="dt">c2=</span><span class="kw"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span>(crit2), <span class="dt">c3=</span><span class="kw"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span>(crit3),</a>
<a class="sourceLine" id="cb20-6" title="6">                           <span class="dt">c4=</span><span class="kw"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span>(crit4), <span class="dt">c6=</span><span class="kw"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span>(crit6))</a>
<a class="sourceLine" id="cb20-7" title="7">                           </a>
<a class="sourceLine" id="cb20-8" title="8"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(corrgram)</a>
<a class="sourceLine" id="cb20-9" title="9">panel.raters &lt;-<span class="st"> </span><span class="cf">function</span> (x, y, <span class="dt">corr =</span> <span class="ot">NULL</span>, col.regions, cor.method, ...) {</a>
<a class="sourceLine" id="cb20-10" title="10">  <span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(corr)) </a>
<a class="sourceLine" id="cb20-11" title="11">    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>()</a>
<a class="sourceLine" id="cb20-12" title="12">  <span class="kw"><a href="https://rdrr.io/r/graphics/plot.xy.html">plot.xy</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/xy.coords.html">xy.coords</a></span>(x, y), <span class="dt">type =</span> <span class="st">"p"</span>, ...)</a>
<a class="sourceLine" id="cb20-13" title="13">  <span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(y <span class="op">~</span><span class="st"> </span>x))</a>
<a class="sourceLine" id="cb20-14" title="14">  <span class="kw"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="dt">col =</span> <span class="st">"lightgray"</span>)</a>
<a class="sourceLine" id="cb20-15" title="15">}</a>
<a class="sourceLine" id="cb20-16" title="16"><span class="kw"><a href="../reference/corrgram.html">corrgram</a></span>(data.ratings3[,<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">diag=</span>panel.density, <span class="dt">lower.panel=</span>panel.raters, <span class="dt">upper.panel=</span>panel.conf)</a></code></pre></div>
<p><img src="corrgram_examples_files/figure-html/unnamed-chunk-1-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</a></code></pre></div>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 7 x64 (build 7601) Service Pack 1
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] Matrix_1.2-17 corrgram_1.14 knitr_1.24   
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.2       lattice_0.20-38  rprojroot_1.3-2  crayon_1.3.4     digest_0.6.20   
##  [6] assertthat_0.2.1 MASS_7.3-51.4    grid_3.6.1       R6_2.4.0         backports_1.1.4 
## [11] magrittr_1.5     evaluate_0.14    stringi_1.4.3    rlang_0.4.0      fs_1.3.1        
## [16] rmarkdown_1.15   pkgdown_1.4.0    desc_1.2.0       tools_3.6.1      stringr_1.4.0   
## [21] yaml_2.2.0       xfun_0.9         compiler_3.6.1   memoise_1.1.0    htmltools_0.3.6</code></pre>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-friendly2002corrgrams">
<p>Friendly, Michael. 2002. “Corrgrams: Exploratory Displays for Correlation Matrices.” <em>The American Statistician</em> 56: 316–24. <a href="https://doi.org/10.1198/000313002533">https://doi.org/10.1198/000313002533</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#abstract">Abstract</a></li>
      <li><a href="#setup">Setup</a></li>
      <li><a href="#figure-2">Figure 2</a></li>
      <li><a href="#figure-3">Figure 3</a></li>
      <li><a href="#figure-4a-4b">Figure 4a, 4b</a></li>
      <li><a href="#figure-5">Figure 5</a></li>
      <li><a href="#figure-6-">Figure 6.</a></li>
      <li><a href="#figure-7-">Figure 7.</a></li>
      <li><a href="#figure-8">Figure 8</a></li>
      <li><a href="#figure-11">Figure 11</a></li>
      <li>
<a href="#further-examples">Further examples</a><ul class="nav nav-pills nav-stacked">
<li><a href="#correlation-matrix">Correlation matrix</a></li>
      <li><a href="#ratings-data">Ratings data</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kevin Wright.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
